# 南工骁鹰视觉组代码编程规范

## 一、前言

本代码规范参考Google开源项目风格指南

## 二、头文件

### 2.1头文件保护

**所有头文件都必须使用`#define `来进行保护，防止头文件被多重包含**

命名格式：`<PROJECT>_<PATH>_<FILE>_H_`

实例：项目`HITSZ_RoboMaster`中的`HITSZ_RoboMaster/armor/include/armorfinder.h`

~~~c++
#ifndef HITSZ_INCLUDE_ARMORFINDER_H_
#define HITSZ_INCLUDE_ARMORFINDER_H_
...
#endif
~~~

### 2.2内联函数(inline)

**将小于10行的工具函数定义为内联函数，内联函数规模不可超过十行，且应尽量使用lambda表达式等技巧构造函数**

**定义:**

> 当函数被声明为内联函数之后, 编译器会将其内联展开, 而不是按通常的函数调用机制进行调用.

**优点:**

> 只要内联的函数体较小, 内联该函数可以令目标代码更加高效. 对于存取函数以及其它函数体比较短, 性能关键的函数, 鼓励使用内联.

**缺点:**

> 滥用内联将导致程序变得更慢. 内联可能使目标代码量或增或减, 这取决于内联函数的大小. 内联非常短小的存取函数通常会减少代码大小, 但内联一个相当大的函数将戏剧性的增加代码大小. 现代处理器由于更好的利用了指令缓存, 小巧的代码往往执行更快。

### 2.3 `#include`的路径和顺序

## 三、函数

### 3.1函数参数顺序

**参数顺序应该按照：输入参数、其他参数、输出参数的顺序书写**

在加入新参数时不要因为它们是新参数就置于参数列表最后, 而是仍然要按照前述的规则, 即将新的输入参数也置于输出参数之前

### 3.2传递引用作为参数

**一个函数接受的参数只能是：值或`const`引用**

实例：

~~~c++
void ArmorFinder(const Mat& src,float position);
~~~

输入参数可以是 `const` 指针, 但决不能是非 `const` 的引用参数, 除非特殊要求, 比如 `swap()`.

**优点**

> 避免了构造临时对象的构造函数、析构函数开销

**缺点**

> 容易对传进来的引用对象造成期望之外的更改，这也是我们传递`const`引用的原因

### 3.3函数重载

**当需要对同一个功能的函数实现不同版本时，若版本较少，可以使用函数重载，若版本较多，且仅根据参数类型不同进行重载，建议使用不同名称的函数**

实例：

~~~c++
class ArmorFinder{
public:
    //类的构造函数一般采用重载+初始化列表方式实现
    void ArmorFinder(string name);
    void ArmorFinder(const ArmorFinder &a);
}
~~~

如果打算重载一个函数, 可以试试改在函数名里加上参数信息. 例如, 用 `AppendString()` 和 `AppendInt()` 等, 而不是一口气重载多个 `Append()`.

总结：在函数版本小于等于3个时使用函数重载

